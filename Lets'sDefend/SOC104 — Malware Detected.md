## SOC104 — Malware Detected

We receive an alert from the SIEM dashboard as shown

![](https://miro.medium.com/v2/resize:fit:700/1*TCRCKcm_nfI_rMoFoINIWA.png)

We get the md5 hash value of the file as :

**c74862e16bcc2b0e02cadb7ab14e3cd6**

Checking the HashValue on VirusTotal we get the results

![](https://miro.medium.com/v2/resize:fit:700/1*XB2Eoptto2OZYnZ2bXvdmw.png)

Only 1 vendor has flagged it as malicious, to be sure we can check with the same info in AnyRun. On AnyRun we get the following Result

![](https://miro.medium.com/v2/resize:fit:700/1*-E53c6peUya8vMw7ALbI5w.png)

Now we have multiple detections as malicious for the same file, clicking on any of them we get this

![](https://miro.medium.com/v2/resize:fit:700/1*AWouldZgBIODApLEw4HJpA.png)

The two processes which are flagged as malicious are **winrar600.exe** and **Uninstall.exe**, we can check what they do by clicking on them

![](https://miro.medium.com/v2/resize:fit:609/1*OmW31mt37S6Sx61wYZFfUw.png)

We see that the reason why the alert was triggered was because this process tried to

1. Create a software uninstall entry
2. Searches for installed software
3. Reads Security Settings of internet explorer
4. Creates/Modifies COM Task schedule Object

# Analysis of Each Action

## 1. Creates a software uninstall entry

- **Benign Reason:** This is standard procedure for any legitimate software. It allows users to easily manage and remove the program through the Windows “Apps & features” (or “Add/Remove Programs”) control panel. In fact, software that _doesn’t_ do this is often considered suspicious
- **Malicious Reason:** Malware and PUPs often do this to appear legitimate and blend in. They are counting on the user seeing a proper uninstall entry and assuming the program is safe. The uninstaller itself might be fake, leaving key components of the malware behind.

## 2. Searches for installed software

- **Benign Reason:** Some legitimate programs need to do this.
- **Compatibility Checkers:** A program might check if you have a required version of Java, .NET, or if you have a conflicting application installed.
- **Software Updaters/Managers:** Tools like Ninite or Patch My PC exist solely to find and update installed software.
- **Antivirus/Anti-malware:** This is their core function.
- **Malicious Reason:** This is a common **reconnaissance** step for malware.
- **Targeting Security Software:** The malware might be looking for specific antivirus or security products to disable them or use exploits against them.
- **Finding Vulnerable Software:** It could be scanning for old, unpatched versions of browsers, PDF readers, or other software to exploit for privilege escalation.

## 3. Reads Security Settings of Internet Explorer

- **Benign Reason:** This is **very rare** for modern, legitimate software. A legacy corporate application might do this to ensure specific ActiveX or security zone settings are configured for it to function. This is an outdated practice.
- **Malicious Reason:** This is **highly suspicious**. Internet Explorer’s security settings are deeply integrated into the Windows operating system. Malware reads these settings to:
- **Identify Weaknesses:** It’s looking for lowered security settings (e.g., allowing unsigned scripts, weak ActiveX controls) that it can exploit to gain further access, download other malicious payloads, or perform browser hijacking.

## 4. Creates/Modifies COM Task Schedule Object

- **Benign Reason:** Many legitimate applications use scheduled tasks for automatic updates (Google Chrome, Adobe) or background operations (backup software, antivirus scans).
- **Malicious Reason:** This is one of the most common methods for malware to achieve **persistence**.
- By creating a scheduled task, the malware ensures that it will automatically run again after a reboot or at a specific time. This makes it resilient to being simply “killed” in the Task Manager.
- Using a **COM Task Schedule Object** is a slightly more advanced and stealthy method than just creating a simple command-line task, as it can be harder for users to find and dissect.

Also checking AnyRun’s report we see that no C2 server has been contacted either. So we can safely say that this file is **not a malware** even though AnyRun has flagged it as so. You can use this article to fill in the questions in the playbook to get the right answer. Thanks for reading!
