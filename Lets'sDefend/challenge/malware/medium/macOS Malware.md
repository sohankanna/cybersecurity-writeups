# macOS Malware

## Challenge Description 

<img width="1153" height="531" alt="image" src="https://github.com/user-attachments/assets/787eab31-8473-40e3-a846-1c2fe81f7b54" />


## Solution and Analysis

The analysis begins by extracting the malware sample from the password-protected archive. We will then use Ghidra to perform static analysis and understand the malware's capabilities by answering key questions about its behavior.

#### Question 1: How many web browsers does this malware target for data extraction?

After loading the binary in Ghidra and navigating to the `main` function, we can find the section of code responsible for targeting browsers. By examining the function calls in the decompiler, we can count the number of distinct browser-related routines being invoked. The screenshot below highlights seven separate calls to functions designed to steal data from different web browsers.

<img width="511" height="482" alt="image" src="https://github.com/user-attachments/assets/83ca6d8a-c5ca-44d9-919e-2c377a45b405" />

Answer: `7`

#### Question 2: How many different cryptocurrency wallets are targeted by malware?

Continuing the analysis within the `main` function, we find a subsequent block of code dedicated to targeting cryptocurrency wallets. The code follows a similar pattern to the browser data theft, calling a series of functions to locate and steal wallet files. The decompiled view shows five distinct function calls related to different cryptocurrency wallets.

<img width="511" height="312" alt="image" src="https://github.com/user-attachments/assets/ad6941c2-5fc7-4c9d-b49a-cf0e4d4ee153" />

Answer: `5`

#### Question 3: What is the specific part of the file path that follows the user's home directory that is related to Coinomi and is used by the malware?

Within the same code block that targets crypto wallets, the malware explicitly defines the file paths it searches for. The specific path for the Coinomi wallet is hardcoded as a string argument and passed to one of the data-grabbing functions. The screenshot highlights the string `Coinomi/wallets/` being used.

<img width="504" height="264" alt="image" src="https://github.com/user-attachments/assets/ddeb8403-7331-405c-bc89-3f7db34c9684" />

Answer : `Coinomi/wallets/`

#### Question 4: What is the Telegram identifier that is used by malware?

The malware uses a hardcoded identifier to target the local Telegram application data. This string is passed to a function that likely constructs the full path to the Telegram data folder on the user's system. The specific identifier is visible in the decompiled code:

<img width="908" height="327" alt="image" src="https://github.com/user-attachments/assets/540ff2dc-e2d3-4974-a190-2d299a743cd8" />

Answer: `6N38VWS5BX.ru.keepcoder.Telegram`

#### Question 5: What IP address is used by malware to send data over HTTP?

To find the command-and-control (C2) server IP address, we can search for the function responsible for data exfiltration, named `send_data_via_http`. Analyzing this function reveals a hardcoded IP address used as the destination for the stolen data.

<img width="904" height="661" alt="image" src="https://github.com/user-attachments/assets/4f6d57ef-2c08-459f-a3c5-26141678bd92" />

Answer : `91.103.252.213`

#### Question 6: What is the offset of the function used to grab chromium?

To find the offset of a specific function, we can use Ghidra's Symbol Tree or search directly for the function name `_SearchAndGrabChromium`. Once located, the function's starting memory address (offset) is displayed in the **Listing view**, on the far-left of the first instruction.

<img width="958" height="247" alt="image" src="https://github.com/user-attachments/assets/720f340c-42f0-43f2-8b67-53c4298227e1" />

Answer: `0x100022DF0`

#### Question 7: What is the offset of the “send_data_via_http” function used by the malware?

Following the same procedure as the previous question, we can locate the `send_data_via_http` function. Its starting offset is also found in the Listing view.

Answer: ` 0x100021DF0`

#### Question 8: What command is used by the malware to obtain information about hardware components on the MacOS system?

The malware gathers system information about the infected machine. By analyzing the function named `userinfo`, we can see that it executes a shell command to retrieve this data. The decompiled code shows a call to `system()` with a specific command string. This command, `system_profiler SPHardwareDataType`, is a legitimate macOS tool used to query detailed hardware information.

<img width="1084" height="738" alt="Screenshot 2025-09-06 124953" src="https://github.com/user-attachments/assets/f80ce248-d1c0-4fe7-bb21-3f225e544ca3" />

Answer: `system_profiler SPHardwareDataType`
